---
title: "R final Project"
author: "Idris A.Ayantoye"
date: "12/2/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## libraries
```{r message=FALSE}
library(readr)
library(ggplot2)
library(tidyverse)
```

## Dataset was downloaded from the CDC website. 
Cause of Death (2005-2015) in the US.
```{r message=FALSE}
cdc <- read_csv("C:/Users/ayantoyeia/Desktop/master/R/cdc.csv")
```

## State population from 2005 - 2015
Population across US states (2005-2015) by age group
```{r warning=FALSE}
ggplot(cdc, aes(x=State,y=Population, fill = `Age Range`))+ggtitle("State's population by Age Group")+
  theme(plot.title = element_text(hjust = 0.5))+
  geom_bar(stat="identity")+theme_classic()+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

## Cause of Death by Locality
Death in Metropolis and non-Metropolis
```{r warning=FALSE}
ggplot(cdc, aes(x=`Cause of Death`, y=`Expected Deaths`, fill=Locality))+geom_bar(stat = "identity")+theme_classic()+theme(axis.text.x = element_text(angle = 90, hjust = 1))+coord_flip()
ggplot(cdc, aes(x=`Cause of Death`, y=`Observed Deaths`, fill=Locality))+geom_bar(stat = "identity")+theme_classic()+theme(axis.text.x = element_text(angle = 90, hjust = 1))+coord_flip()
```

## Expected/Observed deaths (and percent excess death)
Projected and Observed Death toll
```{r warning=FALSE}
cdc$Year <- as.character(cdc$Year)
ggplot(cdc, aes(x=Year, y= `Expected Deaths`, color = "expected"))+geom_point()+geom_line(aes(y=`Observed Deaths`, color="observed"))+ggtitle("Number of death per Year")+ylab("Death")
```

## Percent excess death by cause of death
```{r warning= FALSE}
ggplot(cdc, aes(x=Year, y=`Expected Deaths`, fill = `Cause of Death`))+geom_bar(stat = "identity")+ggtitle("Expected Death by Cause of Death")
ggplot(cdc, aes(x=Year, y=`Observed Deaths`, fill = `Cause of Death`))+geom_bar(stat = "identity")+ggtitle("Observed Death by Cause of Death")
ggplot(cdc, aes(Year, `Percent Potentially Excess Deaths`, fill = `Cause of Death`))+geom_bar(stat = "identity")
```

## Boxplot of Excess Death
Percent Excess Death
```{r warning=FALSE}
ggplot(cdc, aes(`Cause of Death`, `Percent Potentially Excess Deaths`))+geom_boxplot(color = "blue", fill = "yellow")+theme_classic()+theme(axis.text.x = element_text(angle = 90, hjust = 1))+coord_flip()

```



---
title: "OHIP_LDS"
author: "Olivier"
date: "12/9/2019"
output: html_document
---

# Oral Health Related Quality of Life in Loeys-Dietz Syndrome

Patients with **[Loeys-Dietz Syndrome](https://ghr.nlm.nih.gov/condition/loeys-dietz-syndrome)** (LDS), a rare connective tissue disorder characterized by aortic aneurysm as well as craniofacial and dental anomalies, were evaluated at the NIDCR Dental Clinic. LDS is caused by mutations in the *TGFBR1*, *TGFBR2*, *TGFB2*, *TGFB3*, *SMAD2* and *SMAD3* genes.\

The purpose of this study was to compare the **Oral Health Related Quality of Life** (OHRQoL) between patients with LDS and unaffected family members, and to test the influence of various oral manifestations on OHRQoL in this cohort.\

OHRQoL is measured using the Oral Health Impact Profile questionnaire (**OHIP14**) that includes 14 questions related to 7 health domains:\

> **High** OHIP-14 score = **Low** OHRQoL

The cohort included:

* 33 patients with LDS (LDS)
* 16 unaffected family members (UFM)

The datasets used here:

* Demographics and genetics data for patients with LDS
* OHIP-14 scores for patients with LDS
* OHIP-14 scores for UFM
* Oral manifestation data for patients with LDS


## LDS cohort demographics and genetics

### Importing Demographics dataset

```{r, message = FALSE, warning=FALSE}
library(readxl)
library(tidyverse)
library(tableone)
LDS_Patients_demographics <- read_excel("~/Desktop/R_project/LDS_Patients_demographics.xlsx")
names(LDS_Patients_demographics) <- make.names(names(LDS_Patients_demographics))
LDS_Patients_demographics <-  LDS_Patients_demographics %>%
  mutate(Age.group = as.factor(Age.group), Gender = as.factor(Gender), Mode.of.Inheritance = as.factor(Mode.of.Inheritance), Genotype = as.factor(Genotype))
str(LDS_Patients_demographics)
```

### Viewing demographics and genetics (Table)

```{r, message = FALSE, warning=FALSE}
tab1 <- CreateTableOne(data = LDS_Patients_demographics[-1])
kableone(print(tab1, nonnormal = names(LDS_Patients_demographics[-1]),
         format='html', showAllLevels = TRUE))
```

## Impact of demographics and genotype on OHRQoL

### Importing OHIPscore dataset

```{r, message = FALSE, warning=FALSE}
LDS_Patients_OHIPscores <- read_excel("~/Desktop/R_project/LDS_Patients_OHIPscores.xlsx")
names(LDS_Patients_OHIPscores) <- make.names(names(LDS_Patients_OHIPscores))
str(LDS_Patients_OHIPscores)
```

### Calculating OHIP14 score (sum of all health subdomains)

```{r, message = FALSE, warning=FALSE}
LDS_Patients_OHIP14 <- LDS_Patients_OHIPscores %>%
  mutate(OHIP14 = Functional.limitation + Pain + Discomfort + Physical.Disability + Psychological.Disability + Social.Disability + Social.Disability + Handicap)
str(LDS_Patients_OHIP14)
```

```{r, message = FALSE, warning=FALSE}
tab2 <- CreateTableOne(data = LDS_Patients_OHIP14[-1])
kableone(print(tab2, format='html'))
```

### Joining the OHIP14 dataset to the demographics dataset

```{r, message = FALSE, warning=FALSE}
LDS_Demographics_OHIP14 <- LDS_Patients_demographics %>%
  left_join(LDS_Patients_OHIP14)
str(LDS_Demographics_OHIP14)
```

NO EFFECT OF DEMOGRAPHICS ON OHIP14 SCORE (DATA NOT SHOWN).

## Comparing OHIP14 score between patients with LDS and unaffected family members (UFM)

### Importing control dataset

```{r, message = FALSE, warning=FALSE}
UFM_OHIPscores <- read_excel("~/Desktop/R_project/UFM_OHIPscores.xlsx")
names(UFM_OHIPscores) <- make.names(names(UFM_OHIPscores))
str(UFM_OHIPscores)
```

### Calculating OHIP14 score for UFM (sum of all health subdomains)

```{r, message = FALSE, warning=FALSE}
UFM_OHIP14 <- UFM_OHIPscores %>%
  mutate(OHIP14 = Functional.limitation + Pain + Discomfort + Physical.Disability + Psychological.Disability + Social.Disability + Social.Disability + Handicap)
str(UFM_OHIP14)
```

```{r, message = FALSE, warning=FALSE}
tab3 <- CreateTableOne(data = UFM_OHIP14[-1])
kableone(print(tab3, format='html'))
```

### Combining OHIP14 data from LDS patients and UFM

```{r, message = FALSE, warning=FALSE}
LDS_vs_UFM_OHIP14 <- rbind(UFM_OHIP14, LDS_Patients_OHIP14)
str(LDS_vs_UFM_OHIP14)
head(LDS_vs_UFM_OHIP14)
```

### Creating a new factor to distinguish UFM from LDS patients

```{r, message = FALSE, warning=FALSE}
LDS_vs_UFM_OHIP14_grouped <- LDS_vs_UFM_OHIP14 %>%
  separate(col = 'Patient.ID', into = c('Group', 'ID'), sep = '-', remove = F) %>%
  mutate(Group = as.factor(Group)) %>%
  select(-3)
str(LDS_vs_UFM_OHIP14_grouped)
head(LDS_vs_UFM_OHIP14_grouped)
```

### Comparing OHIP14 scores between patients with LDS and UFM (table)

```{r, message = FALSE, warning=FALSE}
tab4 <- CreateTableOne(data = LDS_vs_UFM_OHIP14_grouped[-1], strata = "Group")
kableone(print(tab4, format='html'))
```


### Comparing OHIP14 scores between patients with LDS and UFM (graphic visualization)

```{r, message = FALSE, warning=FALSE}
library(ggplot2)
library(cowplot)
library(ggpubr)
plt10 <- ggplot(LDS_vs_UFM_OHIP14_grouped, aes(x = Group, y = OHIP14)) +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  stat_compare_means()
plt11 <- ggplot(LDS_vs_UFM_OHIP14_grouped, aes(x = Group, y = Functional.limitation)) +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  stat_compare_means()
plt12 <- ggplot(LDS_vs_UFM_OHIP14_grouped, aes(x = Group, y = Pain)) +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  stat_compare_means()
plt13 <- ggplot(LDS_vs_UFM_OHIP14_grouped, aes(x = Group, y = Discomfort)) +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  stat_compare_means()
plt14 <- ggplot(LDS_vs_UFM_OHIP14_grouped, aes(x = Group, y = Physical.Disability)) +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  stat_compare_means()
plt15 <- ggplot(LDS_vs_UFM_OHIP14_grouped, aes(x = Group, y = Social.Disability)) +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  stat_compare_means()
plt16 <- ggplot(LDS_vs_UFM_OHIP14_grouped, aes(x = Group, y = Social.Disability)) +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  stat_compare_means()
plt17 <- ggplot(LDS_vs_UFM_OHIP14_grouped, aes(x = Group, y = Handicap)) +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  stat_compare_means()
plot_grid(plt10, plot_grid(plt11, plt12, plt13, plt14, plt15, plt16, plt17, ncol = 4))
```


### Munging the dataset to use faceted graph

```{r, message = FALSE, warning=FALSE}
LDS_vs_UFM_OHIP14_grouped_2 <- LDS_vs_UFM_OHIP14_grouped %>%
  gather(key = Health.domain, value = Score, -Patient.ID, -Group, -OHIP14)
view(LDS_vs_UFM_OHIP14_grouped_2)
```

### Faceted graph for OHIP scores

```{r, message = FALSE, warning=FALSE}
plt18 <- ggplot(LDS_vs_UFM_OHIP14_grouped_2, aes(x = Group, y = Score)) +
  geom_boxplot() +
  geom_jitter(mapping = aes(color = Health.domain), width = 0.2, show.legend = FALSE) +
  facet_wrap( ~ Health.domain) +
  stat_compare_means()
plt18
```

## Impact of oral manifestations on OHRQoL in patients with LDS

### Importing the Oral Manifestations dataset

```{r, message = FALSE, warning=FALSE}
LDS_Patients_Oral_Manifestations <- read_excel("~/Desktop/R_project/LDS_Patients_Oral_Manifestations.xlsx")
names(LDS_Patients_Oral_Manifestations) <- make.names(names(LDS_Patients_Oral_Manifestations))
LDS_Patients_Oral_Manifestations <- LDS_Patients_Oral_Manifestations %>%
  mutate(Malocclusion = as.factor(Malocclusion), Hypersensitivity = as.factor(Hypersensitivity), Gingivitis = as.factor(Gingivitis), Abnormal.palate = as.factor(Abnormal.palate), TMJ.abnormality = as.factor(TMJ.abnormality))
str(LDS_Patients_Oral_Manifestations)
```


### Joining the OHIP14 dataset to the Oral manifestations dataset

```{r, message = FALSE, warning=FALSE}
LDS_OHIP14_Oral_Manifestations <- LDS_Patients_OHIP14 %>%
  left_join(LDS_Patients_Oral_Manifestations)
str(LDS_OHIP14_Oral_Manifestations)
```

### Visualizing OHIP14 score versus Oral manifestations

```{r, message = FALSE, warning=FALSE}
plt1 <- ggplot(LDS_OHIP14_Oral_Manifestations, aes(x = Malocclusion, y = OHIP14)) +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  stat_compare_means()
plt2 <- ggplot(LDS_OHIP14_Oral_Manifestations, aes(x = Hypersensitivity, y = OHIP14)) +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  stat_compare_means()
plt3 <- ggplot(LDS_OHIP14_Oral_Manifestations, aes(x = Gingivitis, y = OHIP14)) +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  stat_compare_means()
plt4 <- ggplot(LDS_OHIP14_Oral_Manifestations, aes(x = Abnormal.palate, y = OHIP14)) +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  stat_compare_means()
plt5 <- ggplot(LDS_OHIP14_Oral_Manifestations, aes(x = TMJ.abnormality, y = OHIP14)) +
  geom_boxplot() +
  geom_jitter(width = 0.2) +
  stat_compare_means()
plot_grid(plt1, plt2, plt3, plt4, plt5, ncol = 2)
```
